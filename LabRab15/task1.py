import pandas as pd

students = {
    "0170": {"Прізвище": "Завдов'єв", "Ім'я": "Денис", "Адреса": "пр. Михайла Лушпи, 18", "Номер школи": 17, "Клас": 9},
    "0070": {"Прізвище": "Петренко", "Ім'я": "Петро", "Адреса": "вул. Лесі Українки, 25", "Номер школи": 7, "Клас": 9},
    "0171": {"Прізвище": "Сидоренко", "Ім'я": "Оксана", "Адреса": "пр. Михайла Лушпи, 18", "Номер школи": 17, "Клас": 11},
    "0071": {"Прізвище": "Ковальчук", "Ім'я": "Олег", "Адреса": "вул. Лесі Українки, 25", "Номер школи": 7, "Клас": 10},
    "0172": {"Прізвище": "Гончаренко", "Ім'я": "Анна", "Адреса": "пр. Михайла Лушпи, 18", "Номер школи": 17, "Клас": 8},
    "0010": {"Прізвище": "Іваненко", "Ім'я": "Іван", "Адреса": "вул. Герасима Кондратьєва, 136", "Номер школи": 1, "Клас": 10},
    "0173": {"Прізвище": "Петренко", "Ім'я": "Петро", "Адреса": "пр. Михайла Лушпи, 18", "Номер школи": 17, "Клас": 9},
    "0011": {"Прізвище": "Сидоренко", "Ім'я": "Оксана", "Адреса": "вул. Герасима Кондратьєва, 136", "Номер школи": 1, "Клас": 11},
    "0012": {"Прізвище": "Ковальчук", "Ім'я": "Олег", "Адреса": "вул. Герасима Кондратьєва, 136", "Номер школи": 1, "Клас": 10},
    "0230": {"Прізвище": "Гончаренко", "Ім'я": "Анна", "Адреса": "пр. Михайла Лушпи, 36", "Номер школи": 23, "Клас": 8}
}

# Створення DataFrame
df = pd.DataFrame.from_dict(students, orient='index')

# Вивід DataFrame
print("Початковий DataFrame:")
print(df)

# Групування за номером школи
grouped = df.groupby("Номер школи")["Клас"].count()
print("\nКількість учнів у кожній школі:")
print(grouped)

# Агресація: підрахунок учнів за класами
aggregated = df.groupby("Клас")["Прізвище"].count().reset_index()
aggregated.columns = ["Клас", "Кількість учнів"]
print("\nКількість учнів у кожному класі:")
print(aggregated)

# Визначення учнів зі старших класів (10-11) у заданій школі
school_number = int(input("\nВведіть номер школи для пошуку учнів зі старших класів (10-11): "))
senior_students = df[(df["Номер школи"] == school_number) & (df["Клас"].isin([10, 11]))]

print(f"\nУчні зі школи №{school_number}, які навчаються у 10-11 класах:")
if not senior_students.empty:
    print(senior_students[["Прізвище", "Ім'я", "Адреса"]])
else:
    print("Немає учнів, які відповідають умовам.")
